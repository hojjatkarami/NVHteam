function [F_1, F_2, F_3] = force_cal(x, z)

[~,~,k_1,k_2,k_3,c_1,c_2,c_3] = stiff_cal(x,1);

F_1 = zeros(length(z(:,1)),3);
F_2 = F_1;
F_3 = F_1;
% F_1_n = z(:,1);
% F_2_n = z(:,1);
% F_3_n = z(:,1);

r_1 = x(1:3);
r_2 = x(4:6);
r_3 = x(7:9);

% % Position of the mounts
B_1 = [0 -r_1(3) r_1(2) ; r_1(3) 0 -r_1(1) ; -r_1(2) r_1(1) 0];
B_2 = [0 -r_2(3) r_2(2) ; r_2(3) 0 -r_2(1) ; -r_2(2) r_2(1) 0];
B_3 = [0 -r_3(3) r_3(2) ; r_3(3) 0 -r_3(1) ; -r_3(2) r_3(1) 0];

for i = 1:length(z(:,1))  
    F_1(i,:) = (k_1*[eye(3) B_1']*z(i,1:6)' + c_1*[eye(3) B_1']*z(i,7:12)')';
%     F_1_n(i) = norm(F_1(i,:));
    F_2(i,:) = (k_2*[eye(3) B_2']*z(i,1:6)' + c_2*[eye(3) B_2']*z(i,7:12)')';
%     F_2_n(i) = norm(F_2(i,:));
    F_3(i,:) = (k_3*[eye(3) B_3']*z(i,1:6)' + c_3*[eye(3) B_3']*z(i,7:12)')';
%     F_3_n(i) = norm(F_3(i,:));
end